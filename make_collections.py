import os
import numpy as np
import random
import argparse
from tqdm import tqdm
import json

def make_collections(dir, seed, dataset, cls_to_tasks, class_to_dict=None):
    dir = os.path.normpath(dir)
    class_lists = os.listdir(dir)
    base_dir = os.path.basename(os.path.normpath(dir))
    sample_streams = []
    if class_to_dict is None:
        np.random.seed(seed)
        np.random.shuffle(class_lists)
        class_to_dict = {label : idx for idx, label in enumerate(class_lists)}
    else:
        class_lists = list(class_to_dict.keys())
    times = np.linspace(0, 1, len(class_lists))
    task_streams_count = []
    for idx, num_cls in enumerate(cls_to_tasks):
        start_idx = sum(cls_to_tasks[:idx]) if idx != 0 else 0
        task_streams = []
        for cls in class_lists[start_idx:start_idx + num_cls]:
            file_lists = os.listdir(os.path.join(dir, cls))
            for f in file_lists:
                dic = {}
                dic["file_name"] = os.path.join(base_dir, cls, f)
                dic["klass"] = cls
                dic["label"] = class_to_dict[cls]
                dic["time"] = times[idx]
                task_streams.append(dic)
        print("task", idx, class_lists[start_idx:start_idx + num_cls], len(task_streams))
        task_streams_count.append(len(task_streams))
        random.shuffle(task_streams)
        sample_streams.extend(task_streams)
    json_dict = {}
    json_dict["stream"] = sample_streams
    json_dict["cls_dict"] = class_to_dict
    json_dict["cls_addition"] = np.zeros(len(class_lists)).tolist()
    type_name = dir.split("/")[-1]

    if "_" in dataset:
        new_type_name =  "_".join(type_name.split("_")[2:])
    else:
        new_type_name = "_".join(type_name.split("_")[1:])
    
    file_path = f"{dataset}_{new_type_name}_sigma0_repeat1_init100_seed{seed}.json"
    print(file_path)
    with open(file_path, 'w') as outfile:
        json.dump(json_dict, outfile)
    print(task_streams_count)
    print([sum(task_streams_count[:idx+1]) for idx in range(len(task_streams_count))])


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Get mean and std for images')
    parser.add_argument('-r', '--root_dir', type=str, help='Root directory of images')
    parser.add_argument('-s', '--random_seed', help='random seed')
    parser.add_argument('-d', '--dataset', type=str, help='name of the dataset')
    parser.add_argument('-c', '--cls_to_tasks', type=str, help='number of classes per task')
    args = parser.parse_args()
    cls_to_tasks = [int(num) for num in args.cls_to_tasks.split()]
    seeds = [int(s) for s in args.random_seed.split()]
    print(cls_to_tasks)
    print(f"Seeds: {seeds}")
    class_to_dict = None

    if args.dataset == "PACS_final":
        class_to_dict_mappings = {
            1: {'dog':0, 'horse':1, 'guitar':2, 'elephant':3, 'giraffe':4, 'person':5, 'house':6},
            2: {'giraffe':0, 'guitar':1, 'person':2, 'horse':3, 'dog':4, 'house':5, 'elephant':6},
            3: {'giraffe':0, 'dog':1, 'house':2, 'person':3, 'guitar':4, 'elephant':5, 'horse':6},
            4: {'giraffe':0, 'dog':1, 'person':2, 'elephant':3, 'guitar':4, 'house':5, 'horse':6},
            5: {'dog':0, 'horse':1, 'giraffe':2, 'guitar':3, 'elephant':4, 'house':5, 'person':6}
        }
    elif args.dataset == "cct":
        class_to_dict_mappings = {
            1: {'rabbit': 0, 'rodent': 1, 'car': 2, 'bird': 3, 'skunk': 4, 'bobcat': 5, 'squirrel': 6, 'coyote': 7, 'dog': 8, 'opossum': 9, 'cat': 10, 'raccoon': 11},
            2: {'opossum': 0, 'raccoon': 1, 'car': 2, 'coyote': 3, 'skunk': 4, 'bird': 5, 'squirrel': 6, 'rodent': 7, 'rabbit': 8, 'bobcat': 9, 'dog': 10, 'cat': 11},
            3: {'raccoon': 0, 'car': 1, 'skunk': 2, 'rabbit': 3, 'dog': 4, 'bobcat': 5, 'coyote': 6, 'squirrel': 7, 'rodent': 8, 'opossum': 9, 'cat': 10, 'bird': 11},
            4: {'rodent': 0, 'car': 1, 'bobcat': 2, 'opossum': 3, 'cat': 4, 'rabbit': 5, 'dog': 6, 'squirrel': 7, 'skunk': 8, 'raccoon': 9, 'coyote': 10, 'bird': 11},
            5: {'coyote': 0, 'raccoon': 1, 'rabbit': 2, 'opossum': 3, 'dog': 4, 'car': 5, 'cat': 6, 'skunk': 7, 'squirrel': 8, 'bird': 9, 'bobcat': 10, 'rodent': 11}
        }
    elif args.dataset == "DomainNet":
        class_to_dict_mappings = {
            1: {'cookie': 0, 'hand': 1, 'saw': 2, 'cannon': 3, 'stop_sign': 4, 'pliers': 5, 'The_Great_Wall_of_China': 6, 'carrot': 7, 'hot_dog': 8, 'diamond': 9, 'drill': 10, 'bear': 11, 'mermaid': 12, 'mug': 13, 'nose': 14, 'bench': 15, 'couch': 16, 'toothbrush': 17, 'stethoscope': 18, 'toothpaste': 19, 'binoculars': 20, 'cup': 21, 'school_bus': 22, 'octagon': 23, 'stairs': 24, 'goatee': 25, 'pants': 26, 'pickup_truck': 27, 'scorpion': 28, 'grass': 29, 'passport': 30, 'wine_glass': 31, 'owl': 32, 'lollipop': 33, 'snowflake': 34, 'mosquito': 35, 'headphones': 36, 'fireplace': 37, 'toe': 38, 'canoe': 39, 'popsicle': 40, 'tent': 41, 'bread': 42, 'lipstick': 43, 'crab': 44, 'camera': 45, 'coffee_cup': 46, 'blackberry': 47, 'bird': 48, 'broccoli': 49, 'cow': 50, 'power_outlet': 51, 'golf_club': 52, 'fire_hydrant': 53, 'bottlecap': 54, 'spider': 55, 'remote_control': 56, 'asparagus': 57, 'sock': 58, 'lobster': 59, 'river': 60, 'floor_lamp': 61, 'stereo': 62, 'screwdriver': 63, 'sleeping_bag': 64, 'cruise_ship': 65, 'squiggle': 66, 'fish': 67, 'fan': 68, 'soccer_ball': 69, 'postcard': 70, 'hat': 71, 'van': 72, 'camouflage': 73, 'zigzag': 74, 'truck': 75, 't-shirt': 76, 'bracelet': 77, 'ant': 78, 'traffic_light': 79, 'picture_frame': 80, 'sailboat': 81, 'bucket': 82, 'rain': 83, 'ear': 84, 'house_plant': 85, 'eraser': 86, 'squirrel': 87, 'fork': 88, 'keyboard': 89, 'bush': 90, 'shorts': 91, 'lighthouse': 92, 'bat': 93, 'clarinet': 94, 'umbrella': 95, 'mountain': 96, 'cloud': 97, 'beach': 98, 'ladder': 99, 'flamingo': 100, 'house': 101, 'speedboat': 102, 'key': 103, 'dragon': 104, 'pencil': 105, 'feather': 106, 'snake': 107, 'hexagon': 108, 'parachute': 109, 'hockey_stick': 110, 'strawberry': 111, 'aircraft_carrier': 112, 'swan': 113, 'paper_clip': 114, 'pear': 115, 'hourglass': 116, 'star': 117, 'microphone': 118, 'purse': 119, 'leaf': 120, 'bathtub': 121, 'paintbrush': 122, 'helmet': 123, 'teapot': 124, 'clock': 125, 'palm_tree': 126, 'vase': 127, 'tiger': 128, 'hedgehog': 129, 'ambulance': 130, 'windmill': 131, 'eye': 132, 'wristwatch': 133, 'dog': 134, 'whale': 135, 'dishwasher': 136, 'rainbow': 137, 'lion': 138, 'lantern': 139, 'harp': 140, 'police_car': 141, 'compass': 142, 'tree': 143, 'shoe': 144, 'rhinoceros': 145, 'bulldozer': 146, 'cactus': 147, 'telephone': 148, 'helicopter': 149, 'belt': 150, 'skateboard': 151, 'jacket': 152, 'crown': 153, 'pillow': 154, 'hockey_puck': 155, 'horse': 156, 'toilet': 157, 'mailbox': 158, 'paint_can': 159, 'broom': 160, 'church': 161, 'potato': 162, 'grapes': 163, 'sink': 164, 'anvil': 165, 'parrot': 166, 'knee': 167, 'blueberry': 168, 'matches': 169, 'necklace': 170, 'banana': 171, 'rake': 172, 'candle': 173, 'camel': 174, 'pig': 175, 'ice_cream': 176, 'frog': 177, 'pond': 178, 'piano': 179, 'hot_tub': 180, 'yoga': 181, 'flashlight': 182, 'face': 183, 'syringe': 184, 'campfire': 185, 'octopus': 186, 'rifle': 187, 'roller_coaster': 188, 'axe': 189, 'rollerskates': 190, 'cooler': 191, 'alarm_clock': 192, 'sun': 193, 'chandelier': 194, 'monkey': 195, 'cake': 196, 'cello': 197, 'bowtie': 198, 'shovel': 199, 'dresser': 200, 'bed': 201, 'elbow': 202, 'saxophone': 203, 'barn': 204, 'arm': 205, 'crayon': 206, 'submarine': 207, 'jail': 208, 'The_Mona_Lisa': 209, 'wine_bottle': 210, 'toaster': 211, 'tooth': 212, 'fence': 213, 'underwear': 214, 'garden': 215, 'basketball': 216, 'sheep': 217, 'swing_set': 218, 'butterfly': 219, 'angel': 220, 'sandwich': 221, 'smiley_face': 222, 'bee': 223, 'triangle': 224, 'map': 225, 'string_bean': 226, 'bicycle': 227, 'castle': 228, 'animal_migration': 229, 'foot': 230, 'spreadsheet': 231, 'lighter': 232, 'kangaroo': 233, 'oven': 234, 'boomerang': 235, 'drums': 236, 'hospital': 237, 'envelope': 238, 'The_Eiffel_Tower': 239, 'flying_saucer': 240, 'see_saw': 241, 'snowman': 242, 'suitcase': 243, 'train': 244, 'peanut': 245, 'rabbit': 246, 'flower': 247, 'trombone': 248, 'tornado': 249, 'moon': 250, 'diving_board': 251, 'square': 252, 'leg': 253, 'panda': 254, 'calculator': 255, 'pizza': 256, 'sweater': 257, 'wheel': 258, 'microwave': 259, 'skyscraper': 260, 'sea_turtle': 261, 'violin': 262, 'crocodile': 263, 'streetlight': 264, 'washing_machine': 265, 'skull': 266, 'pineapple': 267, 'door': 268, 'dumbbell': 269, 'nail': 270, 'onion': 271, 'dolphin': 272, 'mushroom': 273, 'book': 274, 'watermelon': 275, 'garden_hose': 276, 'mouse': 277, 'cell_phone': 278, 'baseball': 279, 'computer': 280, 'knife': 281, 'firetruck': 282, 'laptop': 283, 'television': 284, 'stitches': 285, 'flip_flops': 286, 'radio': 287, 'trumpet': 288, 'ocean': 289, 'sword': 290, 'tennis_racquet': 291, 'bus': 292, 'shark': 293, 'hot_air_balloon': 294, 'megaphone': 295, 'snorkel': 296, 'stove': 297, 'duck': 298, 'brain': 299, 'apple': 300, 'eyeglasses': 301, 'hammer': 302, 'circle': 303, 'motorbike': 304, 'table': 305, 'airplane': 306, 'baseball_bat': 307, 'penguin': 308, 'steak': 309, 'marker': 310, 'guitar': 311, 'waterslide': 312, 'tractor': 313, 'hurricane': 314, 'spoon': 315, 'birthday_cake': 316, 'pool': 317, 'calendar': 318, 'chair': 319, 'bandage': 320, 'elephant': 321, 'finger': 322, 'peas': 323, 'mouth': 324, 'bridge': 325, 'raccoon': 326, 'car': 327, 'snail': 328, 'light_bulb': 329, 'moustache': 330, 'giraffe': 331, 'backpack': 332, 'ceiling_fan': 333, 'basket': 334, 'lightning': 335, 'cat': 336, 'scissors': 337, 'donut': 338, 'beard': 339, 'frying_pan': 340, 'hamburger': 341, 'teddy-bear': 342, 'zebra': 343, 'line': 344},
            2: {'bench': 0, 'necklace': 1, 'wheel': 2, 'telephone': 3, 'sea_turtle': 4, 'raccoon': 5, 'watermelon': 6, 'streetlight': 7, 'eyeglasses': 8, 'smiley_face': 9, 'sweater': 10, 'mosquito': 11, 'television': 12, 'elephant': 13, 'purse': 14, 'pants': 15, 'pickup_truck': 16, 'tractor': 17, 'elbow': 18, 'tiger': 19, 'campfire': 20, 'kangaroo': 21, 'lipstick': 22, 'paintbrush': 23, 'snorkel': 24, 'dumbbell': 25, 'sleeping_bag': 26, 'finger': 27, 'hat': 28, 'alarm_clock': 29, 'parachute': 30, 'ceiling_fan': 31, 'steak': 32, 'mailbox': 33, 'tornado': 34, 'shark': 35, 'snail': 36, 'skull': 37, 'airplane': 38, 'frog': 39, 'mountain': 40, 'flashlight': 41, 'ambulance': 42, 'mushroom': 43, 'dolphin': 44, 'stereo': 45, 'wine_bottle': 46, 'paint_can': 47, 'hot_dog': 48, 'blueberry': 49, 'lobster': 50, 'flower': 51, 'knee': 52, 'violin': 53, 'pillow': 54, 'stethoscope': 55, 'wine_glass': 56, 'cruise_ship': 57, 'skateboard': 58, 'angel': 59, 'basket': 60, 'triangle': 61, 'moon': 62, 'cow': 63, 'nail': 64, 'soccer_ball': 65, 'church': 66, 'feather': 67, 'clarinet': 68, 'rabbit': 69, 'spoon': 70, 'hockey_stick': 71, 'drums': 72, 'arm': 73, 'hedgehog': 74, 'bed': 75, 'rake': 76, 'helicopter': 77, 'lighthouse': 78, 'pool': 79, 'dresser': 80, 'lighter': 81, 'sink': 82, 'owl': 83, 'square': 84, 'envelope': 85, 'cloud': 86, 'carrot': 87, 'fish': 88, 'sun': 89, 'face': 90, 'star': 91, 'jail': 92, 'submarine': 93, 'beach': 94, 'sheep': 95, 'frying_pan': 96, 'pineapple': 97, 'cooler': 98, 'barn': 99, 'penguin': 100, 'garden_hose': 101, 'panda': 102, 'stairs': 103, 'swing_set': 104, 'cookie': 105, 'radio': 106, 'trumpet': 107, 'peanut': 108, 'jacket': 109, 'rifle': 110, 'backpack': 111, 'ladder': 112, 'anvil': 113, 'palm_tree': 114, 'key': 115, 'pliers': 116, 'coffee_cup': 117, 'dragon': 118, 'snake': 119, 'underwear': 120, 'couch': 121, 'sailboat': 122, 'bus': 123, 'scorpion': 124, 'tent': 125, 'flying_saucer': 126, 'chandelier': 127, 'toothpaste': 128, 'goatee': 129, 'garden': 130, 't-shirt': 131, 'mouth': 132, 'shoe': 133, 'lightning': 134, 'matches': 135, 'book': 136, 'cell_phone': 137, 'duck': 138, 'ant': 139, 'hurricane': 140, 'banana': 141, 'fireplace': 142, 'sword': 143, 'helmet': 144, 'house': 145, 'oven': 146, 'calculator': 147, 'river': 148, 'crayon': 149, 'fire_hydrant': 150, 'see_saw': 151, 'scissors': 152, 'speedboat': 153, 'rainbow': 154, 'ice_cream': 155, 'roller_coaster': 156, 'boomerang': 157, 'fan': 158, 'hot_tub': 159, 'beard': 160, 'bathtub': 161, 'eraser': 162, 'bicycle': 163, 'tree': 164, 'flip_flops': 165, 'guitar': 166, 'butterfly': 167, 'zebra': 168, 'passport': 169, 'camouflage': 170, 'lion': 171, 'camera': 172, 'blackberry': 173, 'bat': 174, 'power_outlet': 175, 'grass': 176, 'stop_sign': 177, 'hexagon': 178, 'yoga': 179, 'saxophone': 180, 'rain': 181, 'line': 182, 'hand': 183, 'leg': 184, 'toe': 185, 'megaphone': 186, 'hot_air_balloon': 187, 'map': 188, 'fork': 189, 'toilet': 190, 'pear': 191, 'cactus': 192, 'mug': 193, 'diving_board': 194, 'drill': 195, 'toaster': 196, 'golf_club': 197, 'bridge': 198, 'postcard': 199, 'animal_migration': 200, 'mouse': 201, 'compass': 202, 'firetruck': 203, 'bird': 204, 'shovel': 205, 'birthday_cake': 206, 'microphone': 207, 'broccoli': 208, 'chair': 209, 'belt': 210, 'snowflake': 211, 'bulldozer': 212, 'giraffe': 213, 'waterslide': 214, 'The_Mona_Lisa': 215, 'bear': 216, 'picture_frame': 217, 'ear': 218, 'piano': 219, 'school_bus': 220, 'shorts': 221, 'candle': 222, 'bowtie': 223, 'bracelet': 224, 'hockey_puck': 225, 'hourglass': 226, 'truck': 227, 'binoculars': 228, 'pencil': 229, 'apple': 230, 'dog': 231, 'parrot': 232, 'police_car': 233, 'pond': 234, 'microwave': 235, 'flamingo': 236, 'paper_clip': 237, 'horse': 238, 'octopus': 239, 'cat': 240, 'foot': 241, 'onion': 242, 'snowman': 243, 'rhinoceros': 244, 'basketball': 245, 'eye': 246, 'donut': 247, 'grapes': 248, 'pizza': 249, 'canoe': 250, 'traffic_light': 251, 'leaf': 252, 'table': 253, 'bush': 254, 'squirrel': 255, 'floor_lamp': 256, 'tennis_racquet': 257, 'spreadsheet': 258, 'umbrella': 259, 'keyboard': 260, 'hospital': 261, 'baseball': 262, 'monkey': 263, 'vase': 264, 'computer': 265, 'sock': 266, 'The_Eiffel_Tower': 267, 'spider': 268, 'saw': 269, 'washing_machine': 270, 'bread': 271, 'house_plant': 272, 'strawberry': 273, 'zigzag': 274, 'diamond': 275, 'castle': 276, 'The_Great_Wall_of_China': 277, 'cello': 278, 'suitcase': 279, 'screwdriver': 280, 'cake': 281, 'whale': 282, 'peas': 283, 'bee': 284, 'syringe': 285, 'windmill': 286, 'lollipop': 287, 'moustache': 288, 'circle': 289, 'hammer': 290, 'mermaid': 291, 'motorbike': 292, 'trombone': 293, 'stitches': 294, 'light_bulb': 295, 'harp': 296, 'asparagus': 297, 'sandwich': 298, 'toothbrush': 299, 'clock': 300, 'axe': 301, 'laptop': 302, 'crab': 303, 'baseball_bat': 304, 'lantern': 305, 'bottlecap': 306, 'headphones': 307, 'car': 308, 'string_bean': 309, 'door': 310, 'popsicle': 311, 'crown': 312, 'marker': 313, 'cup': 314, 'remote_control': 315, 'stove': 316, 'aircraft_carrier': 317, 'hamburger': 318, 'squiggle': 319, 'broom': 320, 'teapot': 321, 'bucket': 322, 'potato': 323, 'cannon': 324, 'ocean': 325, 'swan': 326, 'octagon': 327, 'rollerskates': 328, 'train': 329, 'wristwatch': 330, 'knife': 331, 'bandage': 332, 'pig': 333, 'dishwasher': 334, 'tooth': 335, 'nose': 336, 'van': 337, 'crocodile': 338, 'skyscraper': 339, 'fence': 340, 'calendar': 341, 'teddy-bear': 342, 'brain': 343, 'camel': 344},
            3: {'leaf': 0, 'monkey': 1, 'binoculars': 2, 'brain': 3, 'paper_clip': 4, 'cooler': 5, 'palm_tree': 6, 'television': 7, 'stitches': 8, 'baseball': 9, 'campfire': 10, 'wristwatch': 11, 'ocean': 12, 'hot_tub': 13, 'lantern': 14, 'necklace': 15, 'garden_hose': 16, 'shoe': 17, 'frying_pan': 18, 'shark': 19, 'arm': 20, 'marker': 21, 'pants': 22, 'camouflage': 23, 'cake': 24, 'house_plant': 25, 'barn': 26, 'line': 27, 'animal_migration': 28, 'picture_frame': 29, 'light_bulb': 30, 'crown': 31, 'shovel': 32, 'moon': 33, 'asparagus': 34, 'anvil': 35, 'alarm_clock': 36, 'diamond': 37, 'tiger': 38, 'rake': 39, 'strawberry': 40, 'apple': 41, 'bed': 42, 'guitar': 43, 'cello': 44, 'knee': 45, 'skyscraper': 46, 'foot': 47, 'camera': 48, 'square': 49, 'purse': 50, 'pillow': 51, 'hurricane': 52, 'cannon': 53, 'cup': 54, 'rabbit': 55, 'flip_flops': 56, 'mouth': 57, 'popsicle': 58, 'keyboard': 59, 'tent': 60, 'clock': 61, 'sheep': 62, 'string_bean': 63, 'ceiling_fan': 64, 'sailboat': 65, 'oven': 66, 'sock': 67, 'car': 68, 'teapot': 69, 'tooth': 70, 'bread': 71, 'hat': 72, 'bathtub': 73, 'ant': 74, 'pig': 75, 'parrot': 76, 'postcard': 77, 'hand': 78, 'tree': 79, 'steak': 80, 'blueberry': 81, 'dishwasher': 82, 'hot_dog': 83, 'roller_coaster': 84, 'van': 85, 'snorkel': 86, 'umbrella': 87, 'bench': 88, 'toothbrush': 89, 'stethoscope': 90, 'stove': 91, 'mountain': 92, 'table': 93, 'firetruck': 94, 'sink': 95, 'boomerang': 96, 'lighthouse': 97, 'triangle': 98, 'raccoon': 99, 'radio': 100, 'fence': 101, 'camel': 102, 'giraffe': 103, 'bicycle': 104, 'skateboard': 105, 'squiggle': 106, 'angel': 107, 'pear': 108, 'couch': 109, 'pond': 110, 'skull': 111, 'jail': 112, 'sandwich': 113, 'chandelier': 114, 'trumpet': 115, 'calculator': 116, 'violin': 117, 'hamburger': 118, 'flamingo': 119, 'clarinet': 120, 'goatee': 121, 'power_outlet': 122, 'frog': 123, 'laptop': 124, 'cow': 125, 'eyeglasses': 126, 'peanut': 127, 'bee': 128, 'traffic_light': 129, 'mushroom': 130, 'airplane': 131, 'banana': 132, 'golf_club': 133, 'pencil': 134, 'duck': 135, 'fireplace': 136, 'donut': 137, 'motorbike': 138, 'tornado': 139, 'hexagon': 140, 'spreadsheet': 141, 'onion': 142, 'watermelon': 143, 'butterfly': 144, 'leg': 145, 'lipstick': 146, 'computer': 147, 'octopus': 148, 'rhinoceros': 149, 'mug': 150, 'piano': 151, 'police_car': 152, 'diving_board': 153, 'truck': 154, 'book': 155, 'cruise_ship': 156, 'washing_machine': 157, 'blackberry': 158, 'kangaroo': 159, 'see_saw': 160, 'sweater': 161, 'headphones': 162, 'sleeping_bag': 163, 'eraser': 164, 'windmill': 165, 'teddy-bear': 166, 'bear': 167, 'dumbbell': 168, 'microphone': 169, 'hourglass': 170, 'submarine': 171, 'broccoli': 172, 'cactus': 173, 'lobster': 174, 'cell_phone': 175, 'yoga': 176, 'helmet': 177, 'swing_set': 178, 'trombone': 179, 'zigzag': 180, 'cloud': 181, 'grapes': 182, 'bird': 183, 'flower': 184, 'bowtie': 185, 't-shirt': 186, 'parachute': 187, 'carrot': 188, 'map': 189, 'grass': 190, 'bucket': 191, 'toothpaste': 192, 'train': 193, 'speedboat': 194, 'aircraft_carrier': 195, 'penguin': 196, 'saw': 197, 'sword': 198, 'key': 199, 'peas': 200, 'elbow': 201, 'sun': 202, 'rollerskates': 203, 'toaster': 204, 'vase': 205, 'belt': 206, 'microwave': 207, 'moustache': 208, 'bat': 209, 'saxophone': 210, 'sea_turtle': 211, 'wine_bottle': 212, 'The_Great_Wall_of_China': 213, 'mailbox': 214, 'mouse': 215, 'lightning': 216, 'axe': 217, 'crayon': 218, 'beach': 219, 'stop_sign': 220, 'suitcase': 221, 'dog': 222, 'nose': 223, 'candle': 224, 'beard': 225, 'potato': 226, 'crocodile': 227, 'school_bus': 228, 'syringe': 229, 'ambulance': 230, 'whale': 231, 'pliers': 232, 'pool': 233, 'bottlecap': 234, 'basket': 235, 'lion': 236, 'bulldozer': 237, 'snowflake': 238, 'face': 239, 'floor_lamp': 240, 'scissors': 241, 'lighter': 242, 'canoe': 243, 'hockey_puck': 244, 'bandage': 245, 'paintbrush': 246, 'harp': 247, 'snowman': 248, 'compass': 249, 'envelope': 250, 'calendar': 251, 'spoon': 252, 'bush': 253, 'stereo': 254, 'paint_can': 255, 'bridge': 256, 'knife': 257, 'hockey_stick': 258, 'door': 259, 'mermaid': 260, 'matches': 261, 'church': 262, 'backpack': 263, 'swan': 264, 'megaphone': 265, 'fire_hydrant': 266, 'rainbow': 267, 'circle': 268, 'spider': 269, 'fish': 270, 'scorpion': 271, 'tractor': 272, 'remote_control': 273, 'rain': 274, 'hot_air_balloon': 275, 'crab': 276, 'bus': 277, 'helicopter': 278, 'streetlight': 279, 'stairs': 280, 'smiley_face': 281, 'chair': 282, 'star': 283, 'feather': 284, 'pizza': 285, 'snail': 286, 'pineapple': 287, 'ear': 288, 'dragon': 289, 'toilet': 290, 'finger': 291, 'dresser': 292, 'dolphin': 293, 'basketball': 294, 'drums': 295, 'horse': 296, 'telephone': 297, 'zebra': 298, 'passport': 299, 'birthday_cake': 300, 'ice_cream': 301, 'panda': 302, 'mosquito': 303, 'nail': 304, 'cookie': 305, 'rifle': 306, 'drill': 307, 'river': 308, 'snake': 309, 'squirrel': 310, 'underwear': 311, 'jacket': 312, 'ladder': 313, 'baseball_bat': 314, 'wheel': 315, 'octagon': 316, 'garden': 317, 'broom': 318, 'shorts': 319, 'elephant': 320, 'tennis_racquet': 321, 'screwdriver': 322, 'wine_glass': 323, 'castle': 324, 'eye': 325, 'flashlight': 326, 'cat': 327, 'toe': 328, 'The_Mona_Lisa': 329, 'waterslide': 330, 'soccer_ball': 331, 'hammer': 332, 'fan': 333, 'hospital': 334, 'bracelet': 335, 'lollipop': 336, 'pickup_truck': 337, 'The_Eiffel_Tower': 338, 'hedgehog': 339, 'house': 340, 'owl': 341, 'coffee_cup': 342, 'fork': 343, 'flying_saucer': 344},
            4: {'grapes': 0, 'windmill': 1, 'harp': 2, 'hot_dog': 3, 'bicycle': 4, 'backpack': 5, 'lighthouse': 6, 'ant': 7, 'television': 8, 'hot_tub': 9, 'screwdriver': 10, 'knife': 11, 'anvil': 12, 'roller_coaster': 13, 'stitches': 14, 'matches': 15, 'ambulance': 16, 'pickup_truck': 17, 'goatee': 18, 'dumbbell': 19, 'hat': 20, 'campfire': 21, 'octagon': 22, 'clarinet': 23, 'carrot': 24, 'knee': 25, 'pig': 26, 'teddy-bear': 27, 'stairs': 28, 'wristwatch': 29, 'hourglass': 30, 'train': 31, 'flower': 32, 'duck': 33, 'motorbike': 34, 'skull': 35, 'fan': 36, 'microwave': 37, 'belt': 38, 'sandwich': 39, 'fireplace': 40, 'dragon': 41, 'saw': 42, 'cookie': 43, 'frying_pan': 44, 'pillow': 45, 'raccoon': 46, 'foot': 47, 'bed': 48, 'aircraft_carrier': 49, 'birthday_cake': 50, 'lobster': 51, 'waterslide': 52, 'canoe': 53, 'butterfly': 54, 'shovel': 55, 'umbrella': 56, 'truck': 57, 'oven': 58, 'blackberry': 59, 'hand': 60, 'bee': 61, 'cello': 62, 'leg': 63, 'onion': 64, 'cactus': 65, 'lipstick': 66, 'broom': 67, 'bandage': 68, 'cow': 69, 'scorpion': 70, 'envelope': 71, 'baseball': 72, 'parrot': 73, 'The_Mona_Lisa': 74, 'wine_glass': 75, 'lion': 76, 'ladder': 77, 'tooth': 78, 'alarm_clock': 79, 'banana': 80, 'helicopter': 81, 'map': 82, 'crayon': 83, 'bowtie': 84, 'megaphone': 85, 'sink': 86, 'shark': 87, 'telephone': 88, 'sleeping_bag': 89, 'saxophone': 90, 'traffic_light': 91, 'river': 92, 'toothbrush': 93, 'cat': 94, 'hockey_stick': 95, 'sailboat': 96, 'calculator': 97, 'mountain': 98, 'sword': 99, 'basketball': 100, 'giraffe': 101, 'pliers': 102, 'key': 103, 'wheel': 104, 'microphone': 105, 'cooler': 106, 'compass': 107, 'house_plant': 108, 'swan': 109, 'cup': 110, 'donut': 111, 'pear': 112, 'eraser': 113, 'lightning': 114, 'ocean': 115, 'star': 116, 'flashlight': 117, 'diamond': 118, 'trombone': 119, 'drums': 120, 'shoe': 121, 'axe': 122, 'beard': 123, 'popsicle': 124, 'streetlight': 125, 'bread': 126, 'palm_tree': 127, 'ice_cream': 128, 'book': 129, 'ear': 130, 'syringe': 131, 'headphones': 132, 'submarine': 133, 'helmet': 134, 'paper_clip': 135, 'smiley_face': 136, 'whale': 137, 'passport': 138, 'toilet': 139, 'sweater': 140, 'dresser': 141, 'blueberry': 142, 'rollerskates': 143, 'The_Eiffel_Tower': 144, 'sea_turtle': 145, 'school_bus': 146, 'bulldozer': 147, 'broccoli': 148, 'frog': 149, 'eye': 150, 'jail': 151, 'hexagon': 152, 'rifle': 153, 'peanut': 154, 'crab': 155, 'candle': 156, 'grass': 157, 'circle': 158, 'police_car': 159, 'leaf': 160, 'chair': 161, 'van': 162, 'paintbrush': 163, 'fish': 164, 'suitcase': 165, 'purse': 166, 'diving_board': 167, 'marker': 168, 'hammer': 169, 'boomerang': 170, 'tornado': 171, 'beach': 172, 'couch': 173, 'paint_can': 174, 'violin': 175, 'moustache': 176, 'mouth': 177, 'bush': 178, 'string_bean': 179, 'fork': 180, 'teapot': 181, 'crocodile': 182, 'flip_flops': 183, 'monkey': 184, 'scissors': 185, 'jacket': 186, 'apple': 187, 'hedgehog': 188, 'pineapple': 189, 'power_outlet': 190, 'pizza': 191, 'cruise_ship': 192, 'flying_saucer': 193, 'spoon': 194, 'bathtub': 195, 'line': 196, 'snorkel': 197, 'hockey_puck': 198, 'ceiling_fan': 199, 'clock': 200, 'guitar': 201, 'snail': 202, 'owl': 203, 'postcard': 204, 'tractor': 205, 'cannon': 206, 'square': 207, 'see_saw': 208, 'horse': 209, 'arm': 210, 'dishwasher': 211, 'computer': 212, 'cloud': 213, 'rabbit': 214, 't-shirt': 215, 'elephant': 216, 'spider': 217, 'hospital': 218, 'garden_hose': 219, 'toe': 220, 'table': 221, 'firetruck': 222, 'stethoscope': 223, 'rake': 224, 'church': 225, 'mug': 226, 'tennis_racquet': 227, 'fire_hydrant': 228, 'wine_bottle': 229, 'panda': 230, 'nail': 231, 'bridge': 232, 'snake': 233, 'zebra': 234, 'camouflage': 235, 'mailbox': 236, 'feather': 237, 'tree': 238, 'angel': 239, 'picture_frame': 240, 'snowman': 241, 'stereo': 242, 'bracelet': 243, 'bus': 244, 'lollipop': 245, 'necklace': 246, 'finger': 247, 'brain': 248, 'tent': 249, 'peas': 250, 'shorts': 251, 'lighter': 252, 'castle': 253, 'floor_lamp': 254, 'parachute': 255, 'bat': 256, 'camera': 257, 'soccer_ball': 258, 'bear': 259, 'bench': 260, 'strawberry': 261, 'penguin': 262, 'pond': 263, 'house': 264, 'potato': 265, 'coffee_cup': 266, 'remote_control': 267, 'fence': 268, 'stove': 269, 'face': 270, 'The_Great_Wall_of_China': 271, 'rain': 272, 'pencil': 273, 'crown': 274, 'hot_air_balloon': 275, 'skyscraper': 276, 'skateboard': 277, 'vase': 278, 'underwear': 279, 'spreadsheet': 280, 'drill': 281, 'hurricane': 282, 'bucket': 283, 'snowflake': 284, 'sock': 285, 'toothpaste': 286, 'octopus': 287, 'elbow': 288, 'chandelier': 289, 'basket': 290, 'flamingo': 291, 'swing_set': 292, 'dog': 293, 'radio': 294, 'sun': 295, 'watermelon': 296, 'calendar': 297, 'binoculars': 298, 'barn': 299, 'mushroom': 300, 'garden': 301, 'keyboard': 302, 'asparagus': 303, 'pants': 304, 'moon': 305, 'toaster': 306, 'car': 307, 'hamburger': 308, 'nose': 309, 'triangle': 310, 'lantern': 311, 'airplane': 312, 'bottlecap': 313, 'mermaid': 314, 'speedboat': 315, 'mouse': 316, 'camel': 317, 'baseball_bat': 318, 'laptop': 319, 'steak': 320, 'tiger': 321, 'sheep': 322, 'cake': 323, 'rhinoceros': 324, 'washing_machine': 325, 'piano': 326, 'dolphin': 327, 'squirrel': 328, 'door': 329, 'trumpet': 330, 'stop_sign': 331, 'rainbow': 332, 'yoga': 333, 'pool': 334, 'animal_migration': 335, 'kangaroo': 336, 'eyeglasses': 337, 'light_bulb': 338, 'squiggle': 339, 'zigzag': 340, 'cell_phone': 341, 'bird': 342, 'mosquito': 343, 'golf_club': 344},
            5: {'pig': 0, 'panda': 1, 'circle': 2, 'hexagon': 3, 'pear': 4, 'bush': 5, 'skyscraper': 6, 'picture_frame': 7, 'shark': 8, 'cake': 9, 'bandage': 10, 'police_car': 11, 'necklace': 12, 'lollipop': 13, 'megaphone': 14, 'motorbike': 15, 'bat': 16, 'radio': 17, 'soccer_ball': 18, 'piano': 19, 'onion': 20, 'car': 21, 'garden': 22, 'rake': 23, 'guitar': 24, 'sweater': 25, 'strawberry': 26, 'lipstick': 27, 'swing_set': 28, 'lighter': 29, 'potato': 30, 'headphones': 31, 'square': 32, 'harp': 33, 'fork': 34, 'boomerang': 35, 'knee': 36, 'lightning': 37, 'microphone': 38, 'mug': 39, 'frog': 40, 'toilet': 41, 'banana': 42, 'hand': 43, 'face': 44, 'stove': 45, 'washing_machine': 46, 'cactus': 47, 'smiley_face': 48, 'speedboat': 49, 'snowflake': 50, 'baseball_bat': 51, 'fish': 52, 'lion': 53, 'moon': 54, 'elbow': 55, 'screwdriver': 56, 'fireplace': 57, 'campfire': 58, 'broom': 59, 'purse': 60, 'passport': 61, 'rifle': 62, 'pillow': 63, 'octopus': 64, 'tent': 65, 'penguin': 66, 'roller_coaster': 67, 'aircraft_carrier': 68, 'sink': 69, 'rhinoceros': 70, 'triangle': 71, 'pliers': 72, 'dishwasher': 73, 'telephone': 74, 'paper_clip': 75, 'television': 76, 'leg': 77, 'tiger': 78, 'parrot': 79, 'mermaid': 80, 'see_saw': 81, 'stitches': 82, 'diamond': 83, 'candle': 84, 'beach': 85, 'skateboard': 86, 'paint_can': 87, 'light_bulb': 88, 'key': 89, 'cow': 90, 'spreadsheet': 91, 'snorkel': 92, 'lighthouse': 93, 'toothbrush': 94, 'bed': 95, 'cello': 96, 'bucket': 97, 'sailboat': 98, 'hammer': 99, 'camel': 100, 'carrot': 101, 'shovel': 102, 'parachute': 103, 'flip_flops': 104, 'bench': 105, 'hot_tub': 106, 'bee': 107, 'trombone': 108, 'raccoon': 109, 'snail': 110, 'belt': 111, 'wine_glass': 112, 'basket': 113, 'binoculars': 114, 'cannon': 115, 'mailbox': 116, 'blueberry': 117, 'chair': 118, 'grass': 119, 'sleeping_bag': 120, 'wine_bottle': 121, 'sun': 122, 'zigzag': 123, 'finger': 124, 'stereo': 125, 'bread': 126, 'goatee': 127, 'fan': 128, 'string_bean': 129, 'van': 130, 'line': 131, 'bracelet': 132, 'tooth': 133, 'broccoli': 134, 'crocodile': 135, 'pineapple': 136, 'nose': 137, 'coffee_cup': 138, 'peanut': 139, 'airplane': 140, 'cookie': 141, 'jacket': 142, 'beard': 143, 'angel': 144, 'alarm_clock': 145, 'dog': 146, 'bridge': 147, 'fence': 148, 'dresser': 149, 'toaster': 150, 'horse': 151, 'toothpaste': 152, 'wristwatch': 153, 'ear': 154, 'tree': 155, 'garden_hose': 156, 'pond': 157, 'school_bus': 158, 'anvil': 159, 'firetruck': 160, 'camera': 161, 'ocean': 162, 'dumbbell': 163, 'donut': 164, 'house': 165, 'mosquito': 166, 'leaf': 167, 'submarine': 168, 'windmill': 169, 'sandwich': 170, 'animal_migration': 171, 'flashlight': 172, 'cell_phone': 173, 'castle': 174, 'barn': 175, 'mouth': 176, 'crab': 177, 'skull': 178, 'swan': 179, 'saw': 180, 'bus': 181, 'bowtie': 182, 'rain': 183, 'cat': 184, 'map': 185, 'violin': 186, 'flying_saucer': 187, 'underwear': 188, 'whale': 189, 'blackberry': 190, 'backpack': 191, 'mushroom': 192, 'birthday_cake': 193, 'truck': 194, 'oven': 195, 'shoe': 196, 'bicycle': 197, 'squirrel': 198, 'ambulance': 199, 'shorts': 200, 'compass': 201, 'hockey_stick': 202, 'bird': 203, 'arm': 204, 'computer': 205, 'ceiling_fan': 206, 'spoon': 207, 'The_Eiffel_Tower': 208, 'sea_turtle': 209, 'sock': 210, 'hospital': 211, 'lobster': 212, 'chandelier': 213, 'marker': 214, 'laptop': 215, 'streetlight': 216, 'snake': 217, 'microwave': 218, 'diving_board': 219, 'golf_club': 220, 'sheep': 221, 'octagon': 222, 'apple': 223, 'grapes': 224, 'book': 225, 'clarinet': 226, 'remote_control': 227, 'train': 228, 'brain': 229, 'table': 230, 'rabbit': 231, 'nail': 232, 'wheel': 233, 'pickup_truck': 234, 'pizza': 235, 'foot': 236, 'couch': 237, 'pool': 238, 'mouse': 239, 'canoe': 240, 'hot_air_balloon': 241, 'rollerskates': 242, 'cup': 243, 'squiggle': 244, 'calendar': 245, 'suitcase': 246, 'door': 247, 'waterslide': 248, 'baseball': 249, 'envelope': 250, 'flower': 251, 'axe': 252, 'drums': 253, 'teddy-bear': 254, 'hamburger': 255, 'umbrella': 256, 'church': 257, 'lantern': 258, 'paintbrush': 259, 'fire_hydrant': 260, 'tractor': 261, 'cruise_ship': 262, 'eraser': 263, 'tennis_racquet': 264, 'palm_tree': 265, 'clock': 266, 'giraffe': 267, 'drill': 268, 'trumpet': 269, 'camouflage': 270, 'hurricane': 271, 'duck': 272, 'crayon': 273, 'butterfly': 274, 'helicopter': 275, 'monkey': 276, 'helmet': 277, 'star': 278, 'hockey_puck': 279, 'crown': 280, 'feather': 281, 'zebra': 282, 'keyboard': 283, 'matches': 284, 'toe': 285, 'teapot': 286, 'sword': 287, 'basketball': 288, 'ant': 289, 'kangaroo': 290, 'house_plant': 291, 'pants': 292, 'dragon': 293, 'pencil': 294, 'stairs': 295, 'dolphin': 296, 'scorpion': 297, 'watermelon': 298, 'hourglass': 299, 'eyeglasses': 300, 'snowman': 301, 'traffic_light': 302, 'river': 303, 'hedgehog': 304, 'postcard': 305, 'stop_sign': 306, 'The_Mona_Lisa': 307, 'knife': 308, 'bottlecap': 309, 't-shirt': 310, 'yoga': 311, 'eye': 312, 'owl': 313, 'bear': 314, 'bathtub': 315, 'scissors': 316, 'calculator': 317, 'tornado': 318, 'cloud': 319, 'syringe': 320, 'moustache': 321, 'hot_dog': 322, 'The_Great_Wall_of_China': 323, 'peas': 324, 'steak': 325, 'stethoscope': 326, 'frying_pan': 327, 'cooler': 328, 'rainbow': 329, 'floor_lamp': 330, 'popsicle': 331, 'ice_cream': 332, 'mountain': 333, 'elephant': 334, 'spider': 335, 'vase': 336, 'hat': 337, 'flamingo': 338, 'saxophone': 339, 'bulldozer': 340, 'asparagus': 341, 'jail': 342, 'power_outlet': 343, 'ladder': 344},
        }
    # if args.dataset == "PACS":
    #     if args.random_seed == 1:
    #         class_to_dict = {"dog": 0, "horse": 1, "house": 2, "person": 3, "giraffe": 4, "guitar": 5, "elephant": 6}
    #     elif args.random_seed == 2:
    #         class_to_dict = {"giraffe": 0, "house": 1, "guitar": 2, "horse": 3, "dog": 4, "elephant": 5, "person": 6}
    #     elif args.random_seed == 3:
    #         class_to_dict = {"giraffe": 0, "dog": 1, "elephant": 2, "guitar": 3, "house": 4, "person": 5, "horse": 6}
    #     elif args.random_seed == 4:
    #         class_to_dict = {"giraffe": 0, "dog": 1, "guitar": 2, "person": 3, "house": 4, "elephant": 5, "horse": 6}
    #     elif args.random_seed == 5:
    #         class_to_dict = {"dog": 0, "horse": 1, "giraffe": 2, "house": 3, "person": 4, "elephant": 5, "guitar": 6}


    # elif args.dataset == "PACS_final":
    #     if args.random_seed == 1:
    #         class_to_dict = {'dog':0, 'horse':1, 'guitar':2, 'elephant':3, 'giraffe':4, 'person':5, 'house':6}
    #     elif args.random_seed == 2:
    #         class_to_dict = {'giraffe':0, 'guitar':1, 'person':2, 'horse':3, 'dog':4, 'house':5, 'elephant':6}
    #     elif args.random_seed == 3:
    #         class_to_dict = {'giraffe':0, 'dog':1, 'house':2, 'person':3, 'guitar':4, 'elephant':5, 'horse':6}
    #     elif args.random_seed == 4:
    #         class_to_dict = {'giraffe':0, 'dog':1, 'person':2, 'elephant':3, 'guitar':4, 'house':5, 'horse':6}
    #     elif args.random_seed == 5:
    #         class_to_dict = {'dog':0, 'horse':1, 'giraffe':2, 'guitar':3, 'elephant':4, 'house':5, 'person':6}

    # elif args.dataset == "cifar10":
    #     if args.random_seed == 1:
    #         class_to_dict = {"ship": 0, "dog": 1, "frog": 2, "automobile": 3, "bird": 4, "horse": 5, "cat": 6, "truck": 7, "airplane": 8, "deer": 9}
    #     elif args.random_seed == 2:
    #         class_to_dict = {"automobile": 0, "cat": 1, "deer": 2, "bird": 3, "truck": 4, "ship": 5, "horse": 6, "frog": 7, "dog": 8, "airplane": 9}
    #     elif args.random_seed == 3:
    #         class_to_dict = {"deer": 0, "automobile": 1, "cat": 2, "ship": 3, "dog": 4, "frog": 5, "truck": 6, "bird": 7, "horse": 8, "airplane": 9}
    #     elif args.random_seed == 4:
    #         class_to_dict = {"horse": 0, "airplane": 1, "automobile": 2, "dog": 3, "ship": 4, "frog": 5, "bird": 6, "cat": 7, "deer": 8, "truck": 9}
    #     elif args.random_seed == 5:
    #         class_to_dict = {"dog": 0, "deer": 1, "ship": 2, "automobile": 3, "truck": 4, "cat": 5, "bird": 6, "airplane": 7, "frog": 8, "horse": 9}

    for seed in seeds:
        result = make_collections(args.root_dir, seed, args.dataset, cls_to_tasks, class_to_dict = class_to_dict_mappings[seed])
    # result = make_collections(args.root_dir, args.random_seed, args.dataset, cls_to_tasks, class_to_dict = class_to_dict)

